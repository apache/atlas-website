<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8 from src/site/twiki/Migration-0.8-to-1.0.twiki at 2019-06-27
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190627" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Apache Atlas &#x2013; Migrating data from Apache Atlas 0.8 to Apache Atlas 1.0</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarEnabled">
    <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
            <div class="container" style="width: 68%;"><div class="nav-collapse">
            <ul class="nav">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Apache Atlas <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="index.html" title="Overview">Overview</a></li>
            <li><a href="license.html" title="License">License</a></li>
            <li><a href="../Downloads.html" title="Downloads">Downloads</a></li>
            <li><a href="https://cwiki.apache.org/confluence/display/ATLAS" title="Wiki">Wiki</a></li>
            <li><a href="https://gitbox.apache.org/repos/asf/atlas.git" title="Git">Git</a></li>
            <li><a href="https://issues.apache.org/jira/browse/ATLAS" title="Jira">Jira</a></li>
            <li><a href="https://reviews.apache.org/groups/atlas/?sort=-time_added" title="Review Board">Review Board</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Information <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="project-info.html" title="Summary">Summary</a></li>
            <li><a href="mail-lists.html" title="Mailing Lists">Mailing Lists</a></li>
            <li><a href="team-list.html" title="Team">Team</a></li>
            <li><a href="issue-tracking.html" title="Issue Tracking">Issue Tracking</a></li>
            <li><a href="source-repository.html" title="Source Repository">Source Repository</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Download <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../Downloads.html" target="_blank" title="Source Downloads">Source Downloads</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="../index.html" title="latest">latest</a></li>
            <li><a href="../2.0.0/index.html" title="2.0.0">2.0.0</a></li>
            <li><a href="../1.1.0/index.html" title="1.1.0">1.1.0</a></li>
            <li><a href="../1.0.0/index.html" title="1.0.0">1.0.0</a></li>
            <li><a href="../0.8.3/index.html" title="0.8.3">0.8.3</a></li>
            <li><a href="../0.8.2/index.html" title="0.8.2">0.8.2</a></li>
            <li><a href="../0.8.1/index.html" title="0.8.1">0.8.1</a></li>
            <li><a href="../0.8.0-incubating/index.html" title="0.8-incubating">0.8-incubating</a></li>
            <li><a href="../0.7.1-incubating/index.html" title="0.7.1-incubating">0.7.1-incubating</a></li>
            <li><a href="../0.7.0-incubating/index.html" title="0.7-incubating">0.7-incubating</a></li>
            <li><a href="../0.6.0-incubating/index.html" title="0.6-incubating">0.6-incubating</a></li>
            <li><a href="../0.5.0-incubating/index.html" title="0.5-incubating">0.5-incubating</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">ASF <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="http://www.apache.org/foundation/how-it-works.html" title="How Apache Works">How Apache Works</a></li>
            <li><a href="https://www.apache.org/events/current-event" title="Events">Events</a></li>
            <li><a href="https://www.apache.org/licenses/" title="License">License</a></li>
            <li><a href="http://www.apache.org/foundation/" title="Foundation">Foundation</a></li>
            <li><a href="http://www.apache.org/foundation/sponsorship.html" title="Sponsoring Apache">Sponsoring Apache</a></li>
            <li><a href="http://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></li>
        </ul>
      </li>
            </ul>
<form id="search-form" action="https://www.google.com/search" method="get"  class="navbar-search pull-right" >
  <input value="http://atlas.apache.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript">asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
    <iframe src="https://www.facebook.com/plugins/like.php?href=http://atlas.apache.org/atlas-docs&send=false&layout=button_count&show-faces=false&action=like&colorscheme=dark"
        scrolling="no" frameborder="0"
        style="border:none; width:100px; height:20px; margin-top: 10px;"  class="pull-right" ></iframe>
    <script type="text/javascript">asyncJs( 'https://apis.google.com/js/plusone.js' )</script>
    <ul class="nav pull-right"><li style="margin-top: 10px;">
    <div class="g-plusone" data-href="http://atlas.apache.org/atlas-docs" data-size="medium"  width="60px" align="right" ></div>
    </li></ul>
            </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div id="banner">
        <div class="pull-left"><a href=".." id="bannerLeft"><img src="images/atlas-logo.png"  alt="Apache Atlas" width="200px" height="45px"/></a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
      <li class=""><a href="http://www.apache.org" class="externalLink" title="Apache">Apache</a><span class="divider">/</span></li>
      <li class=""><a href="index.html" title="Atlas">Atlas</a><span class="divider">/</span></li>
    <li class="active ">Migrating data from Apache Atlas 0.8 to Apache Atlas 1.0</li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2019-06-27</li>
          <li id="projectVersion" class="pull-right">Version: 2.0.0</li>
        </ul>
      </div>
        <div id="bodyColumn" >
<div class="section">
<h2><a name="Migrating_data_from_Apache_Atlas_0.8_to_Apache_Atlas_1.0"></a>Migrating data from Apache Atlas 0.8 to Apache Atlas 1.0</h2>
<p>Apache Atlas 1.0 uses JanusGraph graph database to store its type and entity details. Prior versions of Apache Atlas use Titan 0.5.4 graph database. The two databases use different formats for storage. For deployments upgrading from earlier version Apache Atlas, the data in Titan 0.5.4 graph database should be migrated to JanusGraph graph database.</p>
<p>In addition to the change to the graph database, Apache Atlas 1.0 introduces few optimizations that require different internal representation compared to previous versions. Migration steps detailed below will transform data to be compliant with the new internal representation.</p></div>
<div class="section">
<h4><a name="Migration_Steps"></a>Migration Steps</h4>
<p>Migration of data is done in following steps:</p>
<ul>
<li>Planning the migration.</li>
<li>Export Apache Atlas 0.8 data to a directory on the file system.</li>
<li>Import data from exported files into Apache Atlas 1.0.</li></ul></div>
<div class="section">
<h5><a name="Planning_the_migration"></a>Planning the migration</h5>
<p>The duration of migration of data from Apache Atlas 0.8 to Apache Atlas 1.0 can be significant, depending upon the amount of data present in Apache Atlas. This section helps you to estimate the time to migrate, so that you can plan the upgrade process better.</p>
<p>To estimate the time needed to export data, first you need to find the number of entities in Apache Atlas 0.8. This can be done by running the following DSL query:</p>
<div class="source"><pre class="prettyprint">
Referenceable select count()

</pre></div>
<p>Assuming Apache Atlas is deployed in a quad-core CPU with 4 GB of RAM allocated:</p>
<ul>
<li>Export from Apache Atlas 0.8 will process approximately 2 million entities per hour.</li>
<li>Import into Apache Atlas 1.0 will process approximately 0.7 million entities per hour.</li></ul></div>
<div class="section">
<h5><a name="Exporting_data_from_Apache_Atlas_0.8"></a>Exporting data from Apache Atlas 0.8</h5>
<p><i>Atlas Migration Export Utility</i> from Apache Atlas branch-0.8 should be used to export the data from Apache Atlas 0.8 deployments. The implementation of which can be found <a class="externalLink" href="https://github.com/apache/atlas/tree/branch-0.8/tools/atlas-migration-exporter">here</a>.</p>
<p>To build this utility:</p>
<ul>
<li>Navigate to root directory of Apache Atlas branch-0.8 local repo (say, <i>/home/atlas/</i>)</li>
<li>Build using the command: <i>mvn clean -DskipTests package -Pdist</i>.</li>
<li>After successful build, the <i>Atlas Migration Utility</i> can be found in this <i>distro/target</i> directory. (Say, <i>/home/atlas/distro/target/apache-atlas-0.8.3-SNAPSHOT-bin/apache-atlas-0.8.3-SNAPSHOT/tools/migration-exporter</i>)</li></ul>
<p>Move the <i>Atlas Migration Utility</i> directory to the Apache Atlas 0.8 cluster.</p>
<p>Follow these steps to export the data:</p>
<ul>
<li>Shutdown <i>Apache Atlas 0.8</i>, so that the database is not updated while the migration is in progress.</li>
<li>Execute the following command to export Apache Atlas data in Titan graph database to the specified directory:</li></ul>
<div class="source"><pre class="prettyprint">
   atlas_migration_export.py -d &lt;output directory&gt;
</pre></div>
<p>Example:</p>
<div class="source"><pre class="prettyprint">
   /home/atlas-migration-utility/atlas_migration_export.py -d /home/atlas-0.8-data

</pre></div>
<p>On successful execution, <i>Atlas Migration Utility</i> tool will display messages like these:</p>
<div class="source"><pre class="prettyprint">
atlas-migration-export: starting migration export. Log file location /var/log/atlas/atlas-migration-exporter.log
atlas-migration-export: initializing
atlas-migration-export: initialized
atlas-migration-export: exporting typesDef to file /home/atlas-0.8-data/atlas-migration-typesdef.json
atlas-migration-export: exported  typesDef to file /home/atlas-0.8-data/atlas-migration-typesdef.json
atlas-migration-export: exporting data to file /home/atlas-0.8-data/atlas-migration-data.json
atlas-migration-export: exported  data to file /home/atlas-0.8-data/atlas-migration-data.json
atlas-migration-export: completed migration export!

</pre></div>
<p>More details on the progress of export can be found in a log file named <i>atlas-migration-exporter.log</i>, in the log directory specified in <i>atlas-log4j.xml</i>.</p></div>
<div class="section">
<h4><a name="Before_importing_into_Apache_Atlas_1.0"></a>Before importing into Apache Atlas 1.0</h4>
<p></p>
<ul>
<li>For Apache Atlas deployments that use Solr as index store, please ensure that existing Apache Atlas specific collections are deleted or renamed before installing Apache Atlas 1.0.</li></ul>
<p>Apache Atlas specific Solr collections can be deleted using CURL commands shown below:</p>
<div class="source"><pre class="prettyprint">
curl 'http://&lt;solrHost:port&gt;/solr/admin/collections?action=DELETE&amp;name=vertex_index'
curl 'http://&lt;solrHost:port&gt;/solr/admin/collections?action=DELETE&amp;name=edge_index'
curl 'http://&lt;solrHost:port&gt;/solr/admin/collections?action=DELETE&amp;name=fulltext_index'
</pre></div>
<p></p>
<ul>
<li>Create Solr collections for Apache Atlas 1.0</li></ul>Apache Atlas specific Solr collections can be created using CURL commands shown below:
<div class="source"><pre class="prettyprint">
curl 'http://&lt;solrHost:port&gt;/solr/admin/collections?action=CREATE&amp;name=vertex_index&amp;numShards=1&amp;replicationFactor=1&amp;collection.configName=atlas_configs'
curl 'http://&lt;solrHost:port&gt;/solr/admin/collections?action=CREATE&amp;name=edge_index&amp;numShards=1&amp;replicationFactor=1&amp;collection.configName=atlas_configs'
curl 'http://&lt;solrHost:port&gt;/solr/admin/collections?action=CREATE&amp;name=fulltext_index&amp;numShards=1&amp;replicationFactor=1&amp;collection.configName=atlas_configs'
</pre></div>
<p></p>
<ul>
<li>For Apache Atlas deployments that use HBase as backend store, please note that HBase table used by earlier version can't be used by Apache Atlas 1.0. If you are constrained on disk storage space, the table used by earlier version can be removed after successful export of data.
<ul>
<li>Apache Atlas 0.8 uses HBase table named 'atlas_titan' (by default)</li>
<li>Apache Atlas 1.0 uses HBase table named 'atlas_janus' (by default)</li></ul></li></ul>
<p></p>
<ul>
<li>Install Apache Atlas 1.0. Do not start yet!</li></ul>
<p></p>
<ul>
<li>Make sure the directory containing exported data is accessible to Apache Atlas 1.0 instance.</li></ul></div>
<div class="section">
<h5><a name="Importing_Data_into_Apache_Atlas_1.0"></a>Importing Data into Apache Atlas 1.0</h5>
<p>Please follow the steps below to import the data exported above into Apache Atlas 1.0:</p>
<ul>
<li>Specify the location of the directory containing exported data in following property to <i>atlas-application.properties</i>:</li></ul>
<div class="source"><pre class="prettyprint">
atlas.migration.data.filename=&lt;location of the directory containing exported data&gt;
</pre></div>
<p></p>
<ul>
<li>Start Apache Atlas 1.0. Apache Atlas will start in migration mode. It will start importing data from the specified directory.</li></ul>
<p></p>
<ul>
<li>Monitor the progress of import process with the following curl command:</li></ul>
<div class="source"><pre class="prettyprint">
curl -X GET -u admin:&lt;password&gt; -H &quot;Content-Type: application/json&quot; -H &quot;Cache-Control: no-cache&quot; http://&lt;atlasHost&gt;:port/api/atlas/admin/status
</pre></div>
<p>Progress of import will be indicated by a message like this:</p>
<div class="source"><pre class="prettyprint">
{&quot;Status&quot;:&quot;MIGRATING&quot;,&quot;MigrationStatus&quot;:{&quot;operationStatus&quot;:&quot;IN_PROGRESS&quot;,&quot;startTime&quot;:1526512275110,&quot;endTime&quot;:1526512302750,&quot;currentIndex&quot;:10,&quot;currentCounter&quot;:101,&quot;totalCount&quot;:0}}

</pre></div>
<p>Successful completion of the operation will show a message like this:</p>
<div class="source"><pre class="prettyprint">
{&quot;Status&quot;:&quot;MIGRATING&quot;,&quot;MigrationStatus&quot;:{&quot;operationStatus&quot;:&quot;SUCCESS&quot;,&quot;startTime&quot;:1526512275110,&quot;endTime&quot;:1526512302750,&quot;currentIndex&quot;:0,&quot;currentCounter&quot;:0,&quot;totalCount&quot;:371}}

</pre></div>
<p>Once migration import is complete, i.e. <i>operationStatus</i> is <i>SUCCESS</i>, follow the steps given below to restart Apache Atlas in <i>ACTIVE</i> mode for regular use:</p>
<ul>
<li>Stop Apache Atlas 1.0.</li>
<li>Remove property <i>atlas.migration.data.filename</i> from <i>atlas-application.properties</i>.</li>
<li>Start Apache Atlas 1.0.</li></ul></div>
<div class="section">
<h4><a name="Atlas_Entity_Defaults_for_Migrated_Data"></a>Atlas Entity Defaults for Migrated Data</h4>
<p>Apache Atlas 1.0 introduces number of new features. For data that is migrated, the following defaults are set:</p>
<ul>
<li>All classifications will have <i>isPropagate</i> set to <i>false</i>.</li>
<li>Taxonomy terms present in Apache Atlas 0.8, if any, will be converted to classification.</li></ul></div>
<div class="section">
<h5><a name="Handling_of_Entity_Definitions_that_use_Classifications_as_Types"></a>Handling of Entity Definitions that use Classifications as Types</h5>
<p>This features is no longer supported. Classifications that are used as types in <i>attribute definitions</i> (<i><a href="./AttributeDefs.html">AttributeDefs</a></i>) are converted in to new types whose name has <i>legacy</i> prefix. These are then handled like any other type. Creation of such types was prevented in an earlier release, hence only type definitions have potential to exist. Care has been taken to handle entities of this type as well.</p></div>
        </div>
    </div>
    <hr/>
    <footer>
      <div class="container">
        <div class="row">
<p><a href="https://www.apache.org/foundation/contributing"><img src="https://www.apache.org/images/SupportApache-small.png" alt="Support the ASF" id="asf-logo" height="20" width="20" /></a>Copyright © 2011-2018 The Apache Software Foundation. Licensed under the <a href="https://www.apache.org/licenses/">Apache License, Version 2.0</a>.<br/>
Apache Atlas, Atlas, Apache, the Apache feather logo are trademarks of the <a href="https://www.apache.org">Apache Software Foundation</a>.<br/>
All other marks mentioned may be trademarks or registered trademarks of their respective owners.</p>
        </div>
        <p id="poweredBy" class="pull-right"><a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
</p>
      </div>
    </footer>
  </body>
</html>
